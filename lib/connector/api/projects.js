"use strict";function create(a,b,c){void 0===c&&(c=!1),utils.ajax("http://"+models.getServerDomainName()+"/projects"+utils.querify(a),function(a,d){switch(d){case 200:return c||console.log("project id:",a.id),void(b&&b(null,new models.Project(a)));case 400:c||console.log("invalid data:",a);break;case 403:c||console.log("access denied");break;default:c||console.log("server error:",a)}b&&b("undefined"==typeof a?{}:a,null)},"json","post")}function findDescendant(a,b){utils.ajax("http://"+models.getServerDomainName()+"/projects/"+a+utils.querify({find:"descendant",format:"json"}),function(a,c){b(404===c||null===a?null:new models.Project(a))},"json")}function read(a,b){return null!==projectCache&&projectCache.id===a?(b&&setTimeout(function(){b(projectCache)},1),!0):void utils.ajax("http://"+models.getServerDomainName()+"/projects/"+a+utils.querify({format:"json"}),function(a,c){var d=null===a||200!==c?null:new models.Project(a);null!==d&&(projectCache=d),b&&b(d)},"json")}function list(a,b){var c=_.extend({format:"json",withoutOriginalAuthors:!0},b);utils.ajax("http://"+models.getServerDomainName()+"/projects"+utils.querify(c),function(b){if(!b)return a(null,{});var c=b.list;delete b.list,a(_.map(c,function(a){return new models.Project(a)}),b)},"json")}function listVariants(a,b){var c=_.extend({format:"json",withoutAuthors:!0,withoutOriginalAuthors:!0},b);utils.ajax("http://"+models.getServerDomainName()+"/variants"+utils.querify(c),function(b){if(!b)return a(null,{});var c=b.list;delete b.list,a(_.map(c,function(a){return new models.Variant(a)}),b)},"json")}function listAuthors(a,b){utils.ajax("http://"+models.getServerDomainName()+"/users/for/projects/"+a,function(a,c){return 404!==c&&a?void(b&&b(_.map(a,function(a){return new models.User(a)}))):void(b&&b(null))},"json")}function createVariant(a,b){utils.ajax("http://"+models.getServerDomainName()+"/variants"+utils.querify(a),function(a,c){if(200!==c||!a)return void(b&&b(null));var d=new models.Variant(a);"undefined"!=typeof document&&download(d),b&&b(d)},"json","post")}function readVariant(a,b){utils.ajax("http://"+models.getServerDomainName()+"/variants/"+a+utils.querify({format:"json"}),function(a,c){var d=null===a||200!==c?null:new models.Variant(a);b&&b(d)},"json")}function download(a,b){void 0===b&&(b="");var c=document.createElement("a"),d=a.contentType===models.Variant.PROGRAM_NODEJS;c.setAttribute("href",a.getDownloadLinkUrl()),c.setAttribute("download","f3js-"+(d?"nodejs-":"layout-")+a.id+(d?"zip"===b?".zip":".tar":".pdf")),c.style.display="none",document.body.appendChild(c),c.click(),setTimeout(function(){document.body.removeChild(c)},1e3)}var _=require("underscore"),models=require("../models"),utils=require("../utils"),projectCache=null;exports.create=create,exports.findDescendant=findDescendant,exports.read=read,exports.list=list,exports.listVariants=listVariants,exports.listAuthors=listAuthors,exports.createVariant=createVariant,exports.readVariant=readVariant,exports.download=download;/*! f3js-cli - v0.1.2 - 2016-07-10 */
